<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>cover/Elixir.Phlox.TestHelper.html</title>
</head><body style='background-color: white; color: black'>
<pre>
File generated from /Users/iggy/bloc/Projects/phlox/test/support/test_helper.ex by COVER 2018-11-15 at 18:04:33

****************************************************************************

        |  defmodule Phlox.TestHelper do
        |    alias Phlox.Repo
        |    alias Phlox.Accounts.{User, Role}
        |    alias Phlox.Content.Post
        |  
        |    import Ecto, only: [build_assoc: 2]
        |  
        |    def create_role(%{name: name, admin: admin}) do
        |      Role.changeset(%Role{}, %{name: name, admin: admin})
<font color=red>     0..|      |&gt; Repo.insert</font>
        |    end
        |  
        |    def create_user(role, %{email: email, username: username, password: password, password_confirmation: password_confirmation}) do
<font color=red>     0..|      if user = Repo.get_by(User, username: username) do</font>
<font color=red>     0..|        Repo.delete(user)</font>
        |      end
        |  
        |      role
        |      |&gt; build_assoc(:users)
        |      |&gt; User.changeset(%{email: email, username: username, password: password, password_confirmation: password_confirmation})
<font color=red>     0..|      |&gt; Repo.insert</font>
        |    end
        |  
        |    def create_post(user, %{title: title, body: body}) do
        |      user
        |      |&gt; build_assoc(:posts)
        |      |&gt; Post.changeset(%{title: title, body: body})
<font color=red>     0..|      |&gt; Repo.insert</font>
        |    end
        |  end
</pre>
</body>
</html>
